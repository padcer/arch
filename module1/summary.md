### 一、架构的理解
1、基本概念

架构：Architecture，系统蓝图，软件系统的结构，准则，以及对应的描述。属于顶层设计，通过不同组件的协作，描述一个完成的软件系统。如微服务架构、SOA架构。架构是分层的。

框架：Framework，完成特定任务的软件组件，负责某个问题域的解决方案，包含完整的组件规范，以及组件规范对应的软件单元。如Spring框架、Django框架。
系统：完整可运作的工作群体，整体。

子系统：组成系统的个体。

模块：按照逻辑划分的软件组织，可以由不同人员分别协作完成独立的模块。一般指业务模块。如订单模块、账户模块等。

组件：自包含的、可编程的、可复用的软件单元。多个组件组装成一个软件系统。如MQ、Nginx等。

2、4R架构

Rank + Role + Relation + Rule

顶层结构 Rank + 组成角色 Role + 角色关系 Relation + 运作规则 Rule

3、4R架构的应用

架构师职责：
1. 确定层级
2. 拆解角色
3. 定义关系
4. 设计规则

架构文档内容：
* 指明层级
* 描述角色
* 定义关系
* 展现规则

如何学习架构：
1. 自顶向下学习
2. 角色有哪些
3. 角色关系如何
4. 运作规则是什么


### 二、如何画出优秀架构图
1、常见架构图的分类

系统架构、应用架构、部署架构、业务架构、逻辑架构、物理架构。

更细分的领域还包括模型架构、数据架构、安全架构、集成架构等。

4+1架构视图模型：
* 逻辑视图 Logical View：系统提供给用户的功能，对应UML的 class 和 state diagrams；
* 处理视图 Process View：系统的处理过程，对应UML的 sequence 和 activity diagrams；
* 开发视图 Development View：程序员角度看系统的逻辑组成，对应UML的 package diagrams；
* 物理视图 Physical View：系统工程师角度看系统的物理组成，对应UML的 deployment diagrams；
* 场景视图 Scenarios：用户角度看系统需要实现的需求，对应UML的 use case diagrams；

4 + 1架构视图现状：分布式系统需要更复杂的架构描述。

2、大厂常见架构图

业务架构：
* 定义：描述系统对用户提供了什么业务功能，对应于4+1视图的Scenarios场景视图。
* 使用场景：
    1. 产品人员规划业务
    2. 向高层汇报业务
    3. 给新员工培训业务
* 画图技巧：
    1. 通过不同颜色标识业务状态
    2. 业务分组管理

客户端架构/前端架构：
* 定义：客户端和前端的领域逻辑架构，对应于4+1视图的逻辑视图。
* 使用场景：
    1. 整体架构设计
    2. 架构培训
* 画图技巧：
    1. 通过不同颜色标识不同角色
    2. 通过连接线来表示关系

系统架构：
* 定义：后端的逻辑架构，又叫技术架构、后端架构。
* 使用场景：
    1. 整体架构设计
    2. 架构培训
* 画图技巧：
    1. 通过不同颜色标识不同角色
    2. 通过连接线来表示关系

应用架构：
* 定义：描述后端系统由哪些应用组成。微服务场景下，也叫服务架构。
* 使用场景：
    1. 项目开发、测试
    2. 部署发布
    3. 子域架构设计
* 画图技巧：
    1. 通过不同颜色标识不同角色
    2. 通过连接线来表示关系

部署架构：
* 定义：描述后端系统具体是如何部署的。对应4+1视图的物理视图。
* 使用场景：
    1. 总体架构设计
    2. 运维规划和优化
* 画图技巧：
    1. 用图标代替区块

3、其它辅助图形

核心功能还需要提供 Sequence Diagrams时序图、Use Case Diagrams用例图、Data Flow Diagrams数据流图。


### 三、面向复杂度架构设计
1、面向模式

《面向模式的软件架构》架构领域的设计模式。

核心思想：应用经过验证的成熟架构模式，例如MVC、Reactor等。

核心问题：知道模式，但是不知道什么时候用哪个模式。

2、面向风险

《恰如其分的软件架构》风险驱动架构设计方法论，业务架构建模的技巧。

核心思想：根据系统风险大小来设计软件架构。

核心问题：风险是一种概率预判。

建模的内容本质是面向对象设计的建模过程。

3、DDD

《领域驱动设计》——软件核心复杂性应对之道。

DDD是可扩展架构的设计技巧/方法论，不是完整的架构方法论。

DDD、敏捷架构不关注存储和计算，只关注业务。

《架构整洁之道》整洁架构，The Clean Architecture


4、面向复杂度

软件架构诞生背景：软件系统规模增长。

本质：架构设计是为了降低软件系统的复杂度。

思路：通过分析系统需求找到系统复杂的地方，然后设计方案。

模式：复杂度来源包括高性能、高可用、可扩展、安全、成本等。

套路：分库分表、缓存、集群、分片、微服务、DDD、异地多活等。

架构设计路线：需求->(分析)->复杂度->(拆解)->备选架构->(取舍)->架构方案4R->(实现)。


### 四、如何做好架构设计
1、架构设计三原则

合适原则：
* 合适原则宣言：合适优于业界领先。
* 原因：资源约束 + 时间积累 + 业务北京，将军难打无兵之仗 + 罗马不是一天建成 + 业务发展带来技术发展。
* 应用：设计出来的架构要满足当前的业务需要，符合团队和技术的能力水平。

简单原则：
* 简单原则宣言：简单优于复杂。
* 原因：可靠性 + 可扩展 + 故障处理效率，越复杂越不可靠、越复杂越难扩展、越复杂越难处理。
* 若无必要，勿增实体。
* 应用：先按照简单的方式设计架构，然后在实际应用中不断迭代优化。

演化原则：
* 演化原则宣言：演化优于一步到位。
* 创造 + 迭代优化 + 重构重写：满足当前业务需求 + 修改去留适应变化 + 量变引起质变。
* 应用：当业务发生变化时，架构需要扩展、重构，甚至重写。

2、架构感悟

架构设计本质上是“精英设计”。

架构设计需要有落地手段，不能是空中楼阁。

符合团队和业务的架构设计才是最好的。

创业团队不需要超前的架构设计，同样要遵循架构设计三原则。

3、架构设计三原则的具体应用

架构设计过程中，需求分析、复杂度拆解、架构取舍，参考架构设计三原则。

判断维度：业务 + 团队 + 技术
* 业务：
    1. 当前业务的量级
    2. 业务发展速度
    3. 业务的发展形态
* 团队：
    1. 团队规模
    2. 团队能力水平
    3. 投入的资源
* 技术：
    1. 已有技术体系
    2. 当前技术能力
    3. 技术成熟度
